<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>mac10 Dashboard</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
</head>
<body>
  <header>
    <h1>mac10</h1>
    <span id="status-indicator" class="status-dot disconnected"></span>
    <span id="status-text">Connecting...</span>
    <button id="hotkey-trigger-btn" class="hotkey-trigger-btn" title="Hotkey Manager (?)">&#9000;</button>
  </header>

  <main>
    <section id="setup-panel">
      <div id="setup-header">
        <h2>Setup</h2>
        <span id="setup-status"></span>
        <button id="setup-toggle" style="display:none" title="Toggle setup panel">&#9660;</button>
      </div>
      <div id="setup-body">
        <div id="setup-form">
          <div class="setup-field">
            <label for="project-dir">Project Directory</label>
            <input type="text" id="project-dir" placeholder="/path/to/your-project" />
          </div>
          <div class="setup-field">
            <label for="github-repo">GitHub Repo</label>
            <input type="text" id="github-repo" placeholder="owner/repo" />
          </div>
          <div class="setup-field">
            <label for="worker-count">Workers</label>
            <input type="number" id="worker-count" min="1" max="8" value="4" />
          </div>
          <div class="setup-buttons">
            <button id="save-config-btn">Save Config</button>
            <button id="launch-btn">Launch Full Setup</button>
          </div>
          <div id="config-msg" style="display:none"></div>
        </div>
        <div id="setup-output" style="display:none">
          <pre id="setup-log"></pre>
        </div>
      </div>
    </section>

    <section id="request-form">
      <input type="text" id="request-input" placeholder="Describe your coding request..." />
      <button id="request-btn">Submit Request</button>
    </section>

    <section id="masters-panel">
      <h2>Masters</h2>
      <div class="masters-grid">
        <div class="master-card">
          <div class="master-title">Master-1 <span class="master-model">Sonnet</span></div>
          <div class="master-role">Interface</div>
          <span id="master1-status" class="master-status"></span>
          <button id="master1-btn" class="master-btn">Launch</button>
        </div>
        <div class="master-card">
          <div class="master-title">Master-2 <span class="master-model">Opus</span></div>
          <div class="master-role">Architect</div>
          <span id="architect-status" class="master-status"></span>
          <button id="architect-btn" class="master-btn">Launch</button>
        </div>
        <div class="master-card">
          <div class="master-title">Master-3 <span class="master-model">Sonnet</span></div>
          <div class="master-role">Allocator</div>
          <span id="master3-status" class="master-status"></span>
          <button id="master3-btn" class="master-btn">Launch</button>
        </div>
      </div>
    </section>

    <section id="git-panel">
      <div id="git-header">
        <h2>Git</h2>
        <span id="git-repo-label"></span>
      </div>
      <div id="git-actions">
        <button id="git-push-btn" disabled>Push to GitHub</button>
        <span id="git-push-status"></span>
      </div>
      <div id="git-output" style="display:none">
        <pre id="git-log"></pre>
      </div>
    </section>

    <div class="grid">
      <section id="workers-panel">
        <div class="panel-header" data-panel="workers"><h2>Workers</h2></div>
        <div id="workers-list"></div>
      </section>

      <section id="requests-panel">
        <div class="panel-header" data-panel="requests"><h2>Requests</h2></div>
        <div id="requests-list"></div>
      </section>

      <section id="tasks-panel">
        <div class="panel-header" data-panel="tasks"><h2>Tasks</h2></div>
        <div id="tasks-list"></div>
      </section>
    </div>

    <section id="charts-panel">
      <h2>Charts</h2>
      <div class="charts-grid">
        <div class="chart-container">
          <h3>Worker Status</h3>
          <canvas id="worker-chart"></canvas>
        </div>
        <div class="chart-container">
          <h3>Task Status</h3>
          <canvas id="task-chart"></canvas>
        </div>
      </div>
    </section>

    <section id="log-panel">
      <div class="panel-header" data-panel="log"><h2>Activity Log</h2></div>
      <div id="log-list"></div>
    </section>

    <div id="settings-panel" class="settings-panel" style="display:none">
      <div class="settings-panel-title"></div>
      <div class="settings-panel-items"></div>
    </div>

    <!-- Hotkey Manager Modal -->
    <div id="hotkey-overlay" class="hotkey-overlay" style="display:none">
      <div class="hotkey-modal">
        <div class="hotkey-modal-header">
          <h2 style="margin-bottom:0;font-size:14px;text-transform:none;letter-spacing:0;color:#c9d1d9">Hotkey Manager</h2>
          <span class="hotkey-hint">Press <kbd>?</kbd> to open</span>
          <button id="hotkey-close-btn" class="hotkey-close">&times;</button>
        </div>

        <div class="hotkey-body">
          <!-- Add Binding Form -->
          <div class="hotkey-add-form">
            <div class="hotkey-form-row">
              <div class="hotkey-field">
                <label>Key Combo</label>
                <div id="hotkey-capture" class="hotkey-capture" tabindex="0">Click to record...</div>
              </div>
              <div class="hotkey-field" style="flex:1">
                <label>Action</label>
                <select id="hotkey-action-type">
                  <option value="builtin">Built-in Action</option>
                  <option value="script">Custom Script</option>
                </select>
              </div>
              <div class="hotkey-field hotkey-builtin-field" style="flex:1">
                <label>Built-in</label>
                <select id="hotkey-builtin-action">
                  <option value="focus:request">Focus request input</option>
                  <option value="submit:request">Submit request</option>
                  <option value="toggle:setup">Toggle setup panel</option>
                  <option value="toggle:hotkeys">Toggle hotkey manager</option>
                  <option value="scroll:top">Scroll to top</option>
                  <option value="scroll:bottom">Scroll to bottom</option>
                </select>
              </div>
              <button id="hotkey-add-btn" class="hotkey-add-btn">Add</button>
            </div>
            <div class="hotkey-script-field" style="display:none">
              <label>Script</label>
              <textarea id="hotkey-script" rows="3" placeholder="// e.g. document.getElementById('request-input').focus()"></textarea>
            </div>
          </div>

          <!-- Bindings List -->
          <div class="hotkey-list-header">
            <span>Active Bindings</span>
            <span style="font-size:11px;color:#484f58" id="hotkey-count">0 bindings</span>
          </div>
          <div id="hotkey-bindings-list" class="hotkey-bindings-list">
            <div class="hotkey-empty">No hotkeys configured. Add one above.</div>
          </div>

          <!-- Help Reference -->
          <details class="hotkey-help">
            <summary>Action Reference &amp; Scripting Docs</summary>
            <div class="hotkey-help-content">
              <h3>Built-in Actions</h3>
              <table class="hotkey-help-table">
                <tr><td><code>focus:request</code></td><td>Focus the request input field</td></tr>
                <tr><td><code>submit:request</code></td><td>Submit the current request</td></tr>
                <tr><td><code>toggle:setup</code></td><td>Toggle the setup panel open/closed</td></tr>
                <tr><td><code>toggle:hotkeys</code></td><td>Open/close this hotkey manager</td></tr>
                <tr><td><code>scroll:top</code></td><td>Scroll to top of page</td></tr>
                <tr><td><code>scroll:bottom</code></td><td>Scroll to bottom of page</td></tr>
              </table>
              <h3>Custom Scripts</h3>
              <p>Custom scripts execute as JavaScript in the page context. Examples:</p>
              <pre class="hotkey-help-code">// Focus and clear request input
var el = document.getElementById('request-input');
el.focus();
el.value = '';</pre>
              <pre class="hotkey-help-code">// Click the launch setup button
document.getElementById('launch-btn').click();</pre>
              <pre class="hotkey-help-code">// Toggle a panel's visibility
var p = document.getElementById('log-panel');
p.style.display = p.style.display === 'none' ? '' : 'none';</pre>
              <p class="hotkey-help-note">A full scripting language with variables, loops, and macros is planned for Phase 3.</p>
            </div>
          </details>
        </div>
      </div>
    </div>
  </main>

  <script src="app.js"></script>
</body>
</html>
